SECTION .text
GLOBAL AIWNIOS_getcontext
GLOBAL AIWNIOS_setcontext
GLOBAL AIWNIOS_makecontext
AIWNIOS_getcontext:
	POP RDX
	POP RAX
	MOV QWORD [RAX+0*8],RDX
	MOV QWORD [RAX+1*8],RSP
	MOV QWORD [RAX+2*8],RBP
	MOV QWORD [RAX+3*8],R11
	MOV QWORD [RAX+4*8],R12
	MOV QWORD [RAX+5*8],R13
	MOV QWORD [RAX+6*8],R14
	MOV QWORD [RAX+7*8],R15
	MOVSD QWORD [RAX+9*8],XMM6
	MOVSD QWORD [RAX+10*8],XMM7
	MOVSD QWORD [RAX+11*8],XMM8
	MOVSD QWORD [RAX+12*8],XMM9
	MOVSD QWORD [RAX+13*8],XMM10
	MOVSD QWORD [RAX+14*8],XMM11
	MOVSD QWORD [RAX+15*8],XMM12
	MOVSD QWORD [RAX+16*8],XMM13
	MOVSD QWORD [RAX+17*8],XMM14
	MOVSD QWORD [RAX+19*8],XMM15
	MOV QWORD [RAX+20*8],R10
	MOV QWORD [RAX+21*8],RDI
	MOV QWORD [RAX+22*8],RSI
	MOV RAX,0
	JMP RDX
AIWNIOS_setcontext:
	MOV RAX,QWORD [RSP+8]
	MOV RCX,QWORD [RAX+0*8]
	MOV RSP,QWORD [RAX+1*8]
	MOV RBP,QWORD [RAX+2*8]
	MOV R11,QWORD [RAX+3*8]
	MOV R12,QWORD [RAX+4*8]
	MOV R13,QWORD [RAX+5*8]
	MOV R14,QWORD [RAX+6*8]
	MOV R15,QWORD [RAX+7*8]
	MOVSD XMM6,QWORD [RAX+9*8]
	MOVSD XMM7,QWORD [RAX+10*8]
	MOVSD XMM8,QWORD [RAX+11*8]
	MOVSD XMM9,QWORD [RAX+12*8]
	MOVSD XMM10,QWORD [RAX+13*8]
	MOVSD XMM11,QWORD [RAX+14*8]
	MOVSD XMM12,QWORD [RAX+15*8]
	MOVSD XMM13,QWORD [RAX+16*8]
	MOVSD XMM14,QWORD [RAX+17*8]
	MOVSD XMM15,QWORD [RAX+19*8]
	MOV R10,QWORD [RAX+20*8]
	MOV RDI,QWORD [RAX+21*8]
	MOV RSI,QWORD [RAX+22*8]
	MOV RAX,1
	JMP RCX
AIWNIOS_makecontext:
	MOV QWORD [RCX+0*8],RDX
	MOV QWORD [RCX+1*8],R8
	RET
