SECTION .text
GLOBAL TempleOS_CallN
; I64 CallN(fptr,...)
TempleOS_CallN:
	PUSH RBP
	MOV RBP,RSP
	MOV RDX,[RBP+4*8] ;argv 
	MOV RCX,0
	SHL QWORD[RBP+3*8],3
	SUB RSP,QWORD [RBP+3*8]
_loop:
	CMP RCX,[RBP+3*8] ;argc
	JZ en
	MOV RAX,QWORD [RDX+RCX]
	MOV QWORD[RSP+RCX],RAX
	ADD RCX,8
	JMP _loop
en:
	CALL QWORD [RBP+2*8] ;fptr
	LEAVE
	RET 16
