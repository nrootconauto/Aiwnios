SECTION .text
GLOBAL AIWNIOS_getcontext
GLOBAL AIWNIOS_setcontext
GLOBAL AIWNIOS_makecontext
AIWNIOS_getcontext:
	POP RDX
	POP RDI
	MOV QWORD [RDI+0*8],RDX
	MOV QWORD [RDI+1*8],RSP
	MOV QWORD [RDI+2*8],RBP
	MOV QWORD [RDI+3*8],RBX
	MOV QWORD [RDI+4*8],R12
	MOV QWORD [RDI+5*8],R13
	MOV QWORD [RDI+6*8],R14
	MOV QWORD [RDI+7*8],R15
	MOVSD QWORD [RDI+9*8],XMM6
	MOVSD QWORD [RDI+10*8],XMM7
	MOVSD QWORD [RDI+11*8],XMM8
	MOVSD QWORD [RDI+12*8],XMM9
	MOVSD QWORD [RDI+13*8],XMM10
	MOVSD QWORD [RDI+14*8],XMM11
	MOVSD QWORD [RDI+15*8],XMM12
	MOVSD QWORD [RDI+16*8],XMM13
	MOVSD QWORD [RDI+17*8],XMM14
	MOVSD QWORD [RDI+19*8],XMM15
	MOV RAX,0
	JMP RDX
AIWNIOS_setcontext:
	MOV RDI,QWORD [RSP+8]
	MOV RCX,QWORD [RDI+0*8]
	MOV RSP,QWORD [RDI+1*8]
	MOV RBP,QWORD [RDI+2*8]
	MOV RBX,QWORD [RDI+3*8]
	MOV R12,QWORD [RDI+4*8]
	MOV R13,QWORD [RDI+5*8]
	MOV R14,QWORD [RDI+6*8]
	MOV R15,QWORD [RDI+7*8]
	MOVSD XMM6,QWORD [RDI+9*8]
	MOVSD XMM7,QWORD [RDI+10*8]
	MOVSD XMM8,QWORD [RDI+11*8]
	MOVSD XMM9,QWORD [RDI+12*8]
	MOVSD XMM10,QWORD [RDI+13*8]
	MOVSD XMM11,QWORD [RDI+14*8]
	MOVSD XMM12,QWORD [RDI+15*8]
	MOVSD XMM13,QWORD [RDI+16*8]
	MOVSD XMM14,QWORD [RDI+17*8]
	MOVSD XMM15,QWORD [RDI+19*8]
	MOV  RAX,1
	JMP RCX
AIWNIOS_makecontext:
	MOV QWORD [RDI+0*8],RSI
	MOV QWORD [RDI+1*8],RDX
	RET
